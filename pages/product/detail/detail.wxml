<!--pages/product/detail/detail.wxml-->
<view class="container">
  <!-- 商品图片轮播 -->
  <swiper class="product-swiper" indicator-dots="{{true}}" autoplay="{{false}}">
    <swiper-item wx:for="{{product.images}}" wx:key="*this" bindtap="onImageTap" data-index="{{index}}">
      <image class="product-image" src="{{item}}" mode="aspectFill" />
    </swiper-item>
  </swiper>

  <!-- 商品基本信息 -->
  <view class="product-info">
    <view class="product-title">{{product.name}}</view>
    <view class="product-price-section">
      <text class="current-price">¥{{product.price}}</text>
      <text class="original-price" wx:if="{{product.originalPrice}}">¥{{product.originalPrice}}</text>
    </view>
    <view class="product-stats">
      <text class="sales">已售{{product.sales}}</text>
      <text class="rating">评分{{product.rating}}</text>
      <text class="reviews">{{product.reviews}}条评价</text>
    </view>
  </view>

  <!-- 商品规格选择 -->
  <view class="spec-section" wx:if="{{specs.length > 0}}">
    <view class="spec-item" wx:for="{{specs}}" wx:key="name">
      <view class="spec-title">{{item.name}}</view>
      <view class="spec-options">
        <view class="spec-option {{selectedSpec[item.name] === option ? 'selected' : ''}}" 
              wx:for="{{item.options}}" wx:for-item="option" wx:key="*this"
              bindtap="onSpecTap" data-spec-name="{{item.name}}" data-option="{{option}}">
          <text>{{option}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 数量选择 -->
  <view class="quantity-section">
    <text class="quantity-title">数量</text>
    <view class="quantity-control">
      <view class="quantity-btn" bindtap="onQuantityChange" data-type="minus">
        <text>-</text>
      </view>
      <text class="quantity-value">{{quantity}}</text>
      <view class="quantity-btn" bindtap="onQuantityChange" data-type="plus">
        <text>+</text>
      </view>
    </view>
    <text class="stock-info">库存{{product.stock}}件</text>
  </view>

  <!-- 商品描述 -->
  <view class="description-section">
    <view class="section-title">商品详情</view>
    <text class="description-text">{{product.description}}</text>
  </view>

  <!-- 加载状态 -->
  <view class="loading" wx:if="{{loading}}">
    <text>加载中...</text>
  </view>
</view>

<!-- 底部操作栏 -->
<view class="action-bar" wx:if="{{product}}">
  <view class="action-left">
    <view class="action-item" bindtap="onToggleFavorite">
      <image class="action-icon" src="/images/favorite.png" />
      <text>收藏</text>
    </view>
    <navigator url="/pages/cart/cart" class="action-item">
      <image class="action-icon" src="/images/cart.png" />
      <text>购物车</text>
    </navigator>
  </view>
  
  <view class="action-right">
    <view class="add-cart-btn" bindtap="onAddToCart">
      <text>加入购物车</text>
    </view>
    <view class="buy-now-btn" bindtap="onBuyNow">
      <text>立即购买</text>
    </view>
  </view>
</view>